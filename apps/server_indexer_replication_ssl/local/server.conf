{%- for port in conf.replication_ports -%}
[replication_port://{{port.port}}]
disabled = {{ port.disabled|string|lower|default("false",true)}}
{%- if port.ipv6_listen is defined %}
listenOnIPv6 = {{ port.ipv6_listen}}{%-endif%}
{%- if port.accept_from is defined %}
acceptFrom = {{ port.accept_from}}{%-endif%}
{%- endfor %}

{%- for port in conf.replication_ports_ssl -%}
[replication_port-ssl://{{port.port}}]
disabled            = {{ port.disabled|string|lower|default("false",true)}}
{%- if port.ipv6_listen is defined %}
listenOnIPv6 = {{ port.ipv6_listen}}{%-endif%}
{%- if port.accept_from is defined %}
acceptFrom = {{ port.accept_from}}{%-endif%}
{%- if port.SSL is defined %}
#### SSL - port
			{%- if port.SSL.bundle_path is defined %}
serverCert = {{port.SSL.bundle_path|default("/etc/tls/private/splunk.pem",true)}}{%endif%}
			{%- if port.SSL.key_password is defined %}
sslPassword = {{port.SSL.key_password}}{%endif%}
			{%- if port.SSL.require_client_cert is defined %}
requireClientCert = {{port.SSL.require_client_cert|string|lower}}{%endif%}
			{%- if port.SSL.verify_server_cert is defined %}
sslVerifyServerCert = {{port.SSL.verify_server_cert|string|lower}}{%endif%}
			{%- if port.SSL.dh_file_path is defined or conf.SSL.dh_file_path is defined %}
dhFile = {{port.SSL.dh_file_path|default(conf.SSL.dh_file_path)}}{%endif%}
			{%- if port.SSL.trust_chain_path is defined -%}
sslRootCAPath = {{port.SSL.trust_chain_path|default("/etc/tls/cert/splunk-trust-chain.pem",true)}}{%endif%}
			{%- if port.SSL.ssl_versions is defined %}
sslVersions = {{port.SSL.ssl_versions|join(",")}}{%endif%}
			{%- if port.SSL.cipher_suites is defined %}
cipherSuite = {{port.SSL.cipher_suites|join(",")}}{%endif%}
			{%- if port.SSL.ecdh_curves is defined %}
ecdhCurves = {{port.SSL.ecdh_curves|join(",")}}{%endif%}
			{%- if port.SSL.client_ssl_versions is defined %}
sslVersionsForClient = {{port.SSL.client_ssl_versions|join(",")}}{%endif%}
			{%- if port.SSL.dh_file_path is defined %}
sslRootCAPath = {{port.SSL.dh_file_path|default("/etc/pki/tls/private/splunk-dh.pem",true)}}{%-endif%}
			{%- if port.SSL.compression is defined %}
useSSLCompression = {{port.SSL.compression|default(true,true)|string|lower}}{%-endif%}
			{%- if port.SSL.renegotiation is defined %}
allowSslRenegotiation = {{port.SSL.renegotiation|default(true,true)|string|lower}}{%-endif%}
{%- endif %}

{%- if conf.SSL is defined %}
#### SSL - from global conf
			{%- if not port.SSL is defined or not port.SSL.bundle_path is defined %}
serverCert = {{conf.SSL.bundle_path|default(conf.SSL.bundle_path|default("/etc/tls/private/splunk.pem",true),true)}}{%endif%}
			{%- if conf.SSL.key_password is defined %}
sslPassword = {{conf.SSL.key_password}}{%endif%}
			{%- if not port.SSL is defined or not port.SSL.require_client_cert is defined %}
requireClientCert = {{conf.SSL.require_client_cert|default(true,true)|string|lower}}{%endif%}
			{%- if not port.SSL is defined or not port.SSL.verify_server_cert is defined %}
sslVerifyServerCert = {{conf.SSL.verify_server_cert|default(conf.SSL.verify_server_cert|default(true,true))|string|lower}}{%endif%}
			{%-	 if conf.SSL.dh_file_path is defined and not (port.SSL is defined and port.SSL.dh_file_path is defined) %}
dhFile = {{conf.SSL.dh_file_path|default(conf.SSL.dh_file_path)}}{%endif%}
			{%- if conf.SSL.trust_chain_path is defined and not (port.SSL is defined and port.SSL.trust_chain_path is defined) %}
sslRootCAPath = {{conf.SSL.trust_chain_path|default("/etc/tls/cert/splunk-trust-chain.pem",true)}}{%endif%}
			{%- if conf.SSL.ssl_versions is defined and not (port.SSL is defined and port.SSL.ssl_versions is defined) %}
sslVersions = {{conf.SSL.ssl_versions|join(",")}}{%endif%}
			{%- if conf.SSL.cipher_suites is defined and not (port.SSL is defined and port.SSL.cipher_suites is defined) %}
cipherSuite = {{conf.SSL.cipher_suites|join(",")}}{%endif%}
			{%- if conf.SSL.ecdh_curves is defined and not (port.SSL is defined and port.SSL.ecdh_curves is defined) %}
ecdhCurves = {{conf.SSL.ecdh_curves|join(",")}}{%endif%}
			{%- if conf.SSL.client_ssl_versions is defined and not (port.SSL is defined and port.SSL.client_ssl_versions is defined) %}
sslVersionsForClient = {{conf.SSL.client_ssl_versions|join(",")}}{%endif%}
			{%- if conf.SSL.dh_file_path is defined and not (port.SSL is defined and port.SSL.dh_file_path is defined) %}
sslRootCAPath = {{conf.SSL.dh_file_path|default("/etc/pki/tls/private/splunk-dh.pem",true)}}{%-endif%}
			{%- if conf.SSL.compression is defined and not (port.SSL is defined and port.SSL.compression is defined) %}
useSSLCompression = {{conf.SSL.compression|default(true,true)|string|lower}}{%-endif%}
			{%- if conf.SSL.renegotiation is defined and not (port.SSL is defined and port.SSL.renegotiation is defined) %}
allowSslRenegotiation = {{conf.SSL.renegotiation|default(true,true)|string|lower}}{%-endif%}
{%- endif %}
{% endfor %}
